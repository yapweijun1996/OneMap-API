import"./modulepreload-polyfill-B5Qt9EMX.js";const g="https://www.onemap.gov.sg/api",s=e=>document.getElementById(e),E=s("token"),h=s("q"),x=s("geom"),y=s("addr"),$=s("page"),w=s("btn"),c=s("err"),i=s("summary"),u=s("tbody"),p=s("raw"),d=s("btnCopy");function a(e){if(!e){c.classList.add("hidden"),c.textContent="";return}c.classList.remove("hidden"),c.textContent=e}function C(e){u.innerHTML="";for(const o of e){const n=document.createElement("tr");n.className="hover:bg-slate-50",n.innerHTML=`
            <td class="px-3 py-2 font-semibold text-slate-900">${l(o.SEARCHVAL||"")}</td>
            <td class="px-3 py-2 text-slate-700">${l(o.ADDRESS||"")}</td>
            <td class="px-3 py-2 font-mono text-slate-700">${l(o.LATITUDE||"")}</td>
            <td class="px-3 py-2 font-mono text-slate-700">${l(o.LONGITUDE||"")}</td>
          `,u.appendChild(n)}}function l(e){return String(e).replace(/[&<>"']/g,o=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[o])}async function N(e,o){const n=await fetch(e,o),r=await n.text().catch(()=>"");if(!n.ok)throw new Error(`${n.status} ${n.statusText}${r?` - ${r}`:""}`);return r?JSON.parse(r):{}}w.addEventListener("click",async()=>{a(null),d.disabled=!0,i.textContent="请求中…",p.textContent="",u.innerHTML="";const e=(E.value||"").trim(),o=(h.value||"").trim(),n=parseInt($.value||"1",10);if(!e)return a("请先填写 token（可从 auth-token demo 获取）");if(!o)return a("请填写 SearchVal");if(!Number.isFinite(n)||n<=0)return a("PageNum 必须是正整数");const r=`${g}/common/elastic/search?searchVal=${encodeURIComponent(o)}&returnGeom=${x.checked?"Y":"N"}&getAddrDetails=${y.checked?"Y":"N"}&pageNum=${encodeURIComponent(n)}`;try{const t=await N(r,{headers:{Authorization:`Bearer ${e}`}});p.textContent=JSON.stringify(t,null,2),d.disabled=!1,d.onclick=async()=>navigator.clipboard.writeText(JSON.stringify(t,null,2));const f=(t==null?void 0:t.found)??0,m=Array.isArray(t==null?void 0:t.results)?t.results:[];i.textContent=`found=${f}，本页结果=${m.length}，pageNum=${(t==null?void 0:t.pageNum)??n}`,C(m.slice(0,50))}catch(t){a((t==null?void 0:t.message)||"请求失败"),i.textContent="等待请求…"}});
