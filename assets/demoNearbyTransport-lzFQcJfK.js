import"./modulepreload-polyfill-B5Qt9EMX.js";const g="https://www.onemap.gov.sg/api",s=n=>document.getElementById(n),S=s("token"),T=s("lat"),L=s("lng"),N=s("radius"),k=s("btn"),c=s("err"),u=s("summary"),x=s("busTbody"),$=s("mrtTbody"),h=s("raw"),p=s("btnCopy");function l(n){if(!n){c.classList.add("hidden"),c.textContent="";return}c.classList.remove("hidden"),c.textContent=n}function a(n){return String(n).replace(/[&<>"']/g,o=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[o])}function E(n,o){n.innerHTML="";for(const t of o){const e=document.createElement("tr");e.className="hover:bg-slate-50",e.innerHTML=`
            <td class="px-3 py-2 font-mono text-slate-700">${a((t==null?void 0:t.id)??"")}</td>
            <td class="px-3 py-2 font-semibold text-slate-900">${a((t==null?void 0:t.name)??"")}</td>
            <td class="px-3 py-2 text-slate-700">${a((t==null?void 0:t.road)??"")}</td>
            <td class="px-3 py-2 font-mono text-slate-700">${a((t==null?void 0:t.lat)??"")}</td>
            <td class="px-3 py-2 font-mono text-slate-700">${a((t==null?void 0:t.lon)??"")}</td>
          `,n.appendChild(e)}}async function w(n,o){const t=await fetch(n,o),e=await t.text().catch(()=>"");if(!t.ok)throw new Error(`${t.status} ${t.statusText}${e?` - ${e}`:""}`);return e?JSON.parse(e):{}}k.addEventListener("click",async()=>{l(null),p.disabled=!0,u.textContent="请求中…",h.textContent="",x.innerHTML="",$.innerHTML="";const n=parseFloat((T.value||"").trim()),o=parseFloat((L.value||"").trim()),t=parseInt((N.value||"").trim(),10);if(!Number.isFinite(n)||!Number.isFinite(o))return l("lat/lng 必须是数字");if(!Number.isFinite(t)||t<=0)return l("radius_in_meters 必须是正整数");const e={},m=(S.value||"").trim();m&&(e.Authorization=`Bearer ${m}`);const b=`latitude=${encodeURIComponent(n)}&longitude=${encodeURIComponent(o)}&radius_in_meters=${encodeURIComponent(t)}`,C=`${g}/public/nearbysvc/getNearestBusStops?${b}`,v=`${g}/public/nearbysvc/getNearestMrtStops?${b}`;try{const[r,y]=await Promise.all([w(C,Object.keys(e).length?{headers:e}:void 0),w(v,Object.keys(e).length?{headers:e}:void 0)]),i=Array.isArray(r)?r:[],d=Array.isArray(y)?y:[],f={busStops:i,mrtStops:d};h.textContent=JSON.stringify(f,null,2),p.disabled=!1,p.onclick=async()=>navigator.clipboard.writeText(JSON.stringify(f,null,2)),u.textContent=`busStops=${i.length}，mrtStops=${d.length}`,E(x,i.slice(0,30)),E($,d.slice(0,30))}catch(r){l((r==null?void 0:r.message)||"请求失败"),u.textContent="等待请求…"}});
