import"./modulepreload-polyfill-B5Qt9EMX.js";const f="https://www.onemap.gov.sg/api",s=o=>document.getElementById(o),h=s("mode"),$=s("start"),x=s("end"),y=s("btn"),i=s("err"),d=s("summary"),m=s("raw"),p=s("btnCopy");function u(o){if(!o){i.classList.add("hidden"),i.textContent="";return}i.classList.remove("hidden"),i.textContent=o}function g(o){const n=String(o||"").trim().match(/^(-?\d+(\.\d+)?),\s*(-?\d+(\.\d+)?)$/);if(!n)return null;const e=parseFloat(n[1]),a=parseFloat(n[3]);return!Number.isFinite(e)||!Number.isFinite(a)?null:{lat:e,lng:a}}async function w(o){const n=await fetch(o),e=await n.text().catch(()=>"");if(!n.ok)throw new Error(`${n.status} ${n.statusText}${e?` - ${e}`:""}`);return e?JSON.parse(e):{}}function E(o){const n=[];let e=0,a=0,t=0;for(;e<o.length;){let r,c=0,l=0;do r=o.charCodeAt(e++)-63,l|=(r&31)<<c,c+=5;while(r>=32);a+=l&1?~(l>>1):l>>1,c=0,l=0;do r=o.charCodeAt(e++)-63,l|=(r&31)<<c,c+=5;while(r>=32);t+=l&1?~(l>>1):l>>1,n.push([a/1e5,t/1e5])}return n}y.addEventListener("click",async()=>{u(null),p.disabled=!0,m.textContent="",d.textContent="请求中…";const o=h.value,n=g($.value),e=g(x.value);if(!n)return u("Start 格式必须是：lat,lng");if(!e)return u("End 格式必须是：lat,lng");const a=`${f}/public/routingsvc/route?start=${encodeURIComponent(`${n.lat},${n.lng}`)}&end=${encodeURIComponent(`${e.lat},${e.lng}`)}&routeType=${encodeURIComponent(o)}`;try{const t=await w(a);m.textContent=JSON.stringify(t,null,2),p.disabled=!1,p.onclick=async()=>navigator.clipboard.writeText(JSON.stringify(t,null,2));const r=t==null?void 0:t.route_summary,c=t!=null&&t.route_geometry?E(t.route_geometry).length:0;d.textContent=`total_distance=${(r==null?void 0:r.total_distance)??"-"}，total_time=${(r==null?void 0:r.total_time)??"-"}，polyline_points=${c}`}catch(t){u((t==null?void 0:t.message)||"请求失败"),d.textContent="等待请求…"}});
