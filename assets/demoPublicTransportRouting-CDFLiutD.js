import"./modulepreload-polyfill-B5Qt9EMX.js";const C="https://www.onemap.gov.sg/api",s=t=>document.getElementById(t),b=s("token"),w=s("start"),h=s("end"),I=s("date"),T=s("time"),L=s("maxWalk"),N=s("n"),R=s("mode"),S=s("btn"),u=s("err"),$=s("summary"),g=s("itins"),E=s("raw"),x=s("btnCopy");function o(t){if(!t){u.classList.add("hidden"),u.textContent="";return}u.classList.remove("hidden"),u.textContent=t}function p(t){return String(t).replace(/[&<>"']/g,n=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[n])}function k(t){const n=String(t||"").trim().match(/^(-?\d+(\.\d+)?),\s*(-?\d+(\.\d+)?)$/);if(!n)return null;const r=parseFloat(n[1]),a=parseFloat(n[3]);return!Number.isFinite(r)||!Number.isFinite(a)?null:{lat:r,lng:a}}async function U(t,n){const r=await fetch(t,n),a=await r.text().catch(()=>"");if(!r.ok)throw new Error(`${r.status} ${r.statusText}${a?` - ${a}`:""}`);return a?JSON.parse(a):{}}function F(t){var r;g.innerHTML="";const n=Array.isArray((r=t==null?void 0:t.plan)==null?void 0:r.itineraries)?t.plan.itineraries:[];for(const[a,e]of n.entries()){const l=e==null?void 0:e.duration,d=e==null?void 0:e.walkTime,m=e==null?void 0:e.transitTime,f=e==null?void 0:e.transfers,c=document.createElement("div");c.className="rounded-xl border border-slate-200 bg-slate-50 p-3",c.innerHTML=`
            <div class="flex items-center justify-between gap-2">
              <div class="text-sm font-bold text-slate-900">Itinerary #${a+1}</div>
              <div class="text-xs text-slate-600">duration=${p(l??"-")}</div>
            </div>
            <div class="mt-1 text-xs text-slate-700">walkTime=${p(d??"-")} • transitTime=${p(m??"-")} • transfers=${p(f??"-")}</div>
          `,g.appendChild(c)}return n.length}S.addEventListener("click",async()=>{var c;o(null),x.disabled=!0,$.textContent="请求中…",E.textContent="",g.innerHTML="";const t=(b.value||"").trim();if(!t)return o("此接口通常需要 token：请先用 auth-token demo 获取 access_token");const n=k(w.value),r=k(h.value);if(!n)return o("Start 格式必须是：lat,lng");if(!r)return o("End 格式必须是：lat,lng");const a=(I.value||"").trim(),e=(T.value||"").trim(),l=parseInt((L.value||"").trim(),10),d=parseInt((N.value||"").trim(),10),m=(R.value||"").trim();if(!/^\d{2}-\d{2}-\d{4}$/.test(a))return o("date 格式必须是 MM-DD-YYYY");if(!/^\d{2}:\d{2}:\d{2}$/.test(e))return o("time 格式必须是 HH:mm:ss");if(!Number.isFinite(l)||l<=0)return o("maxWalkDistance 必须是正整数");if(!Number.isFinite(d)||d<=0)return o("numItineraries 必须是正整数");if(!m)return o("mode 不能为空");const f=`${C}/public/routingsvc/route?start=${encodeURIComponent(`${n.lat},${n.lng}`)}&end=${encodeURIComponent(`${r.lat},${r.lng}`)}&routeType=pt&date=${encodeURIComponent(a)}&time=${encodeURIComponent(e)}&mode=${encodeURIComponent(m)}&maxWalkDistance=${encodeURIComponent(l)}&numItineraries=${encodeURIComponent(d)}`;try{const i=await U(f,{headers:{Authorization:`Bearer ${t}`}});E.textContent=JSON.stringify(i,null,2),x.disabled=!1,x.onclick=async()=>navigator.clipboard.writeText(JSON.stringify(i,null,2));const y=F(i),v=(c=i==null?void 0:i.error)==null?void 0:c.msg;$.textContent=v?`error=${v}`:`itineraries=${y}`}catch(i){o((i==null?void 0:i.message)||"请求失败"),$.textContent="等待请求…"}});
